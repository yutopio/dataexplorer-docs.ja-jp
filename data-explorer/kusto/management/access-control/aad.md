---
title: Kusto Azure Active Directory (AAD) 認証-Azure データエクスプローラー
description: この記事では、Azure データエクスプローラーでの Azure Active Directory (AAD) 認証について説明します。
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.custom: has-adal-ref
ms.date: 09/13/2019
ms.openlocfilehash: 85d01c9192c71b3274907e5f93e4155b4c98accf
ms.sourcegitcommit: fd3bf300811243fc6ae47a309e24027d50f67d7e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/13/2020
ms.locfileid: "83382218"
---
# <a name="azure-active-directory-aad-authentication"></a>Azure Active Directory (AAD) 認証

Azure Active Directory (AAD) は、Azure の優先マルチテナント クラウド ディレクトリ サービスであり、セキュリティ プリンシパルの認証や、Microsoft の Active Directory などの他の ID プロバイダーとのフェデレーションに対応できます。

AAD では、さまざまな種類 (web アプリケーション、Windows デスクトップアプリケーション、ユニバーサルアプリケーション、モバイルアプリケーションなど) をアプリケーションで一貫して認証し、Kusto サービスを使用することができます。

AAD では、さまざまな認証シナリオがサポートされています。
認証中にユーザーが存在する場合は、AAD ユーザー認証によって AAD に対してユーザーを認証する必要があります。
場合によっては、ユーザーが対話的に表示されていない場合でも、サービスで Kusto を使用する必要がある場合があります。 このような場合は、「AAD アプリケーション認証」で説明されているように、アプリケーションシークレットを使用してアプリケーションを認証する必要があります。

次の認証方法は、一般に、.NET ライブラリを通じて、Kusto でサポートされています。

* 対話型ユーザー認証-このモードでは、必要に応じて対話機能が必要です。ログオン UI がポップアップ表示されます。
* 以前に Kusto に発行された既存の AAD トークンを使用したユーザー認証
* AppID と共有シークレットを使用したアプリケーション認証
* ローカルにインストールされた x.509v3 証明書またはインライン証明書を使用したアプリケーション認証
* 以前に Kusto に発行された既存の AAD トークンを使用したアプリケーション認証
* 別のリソースに対して発行された AAD トークンを使用したユーザー認証またはアプリケーション認証。そのリソースと Kusto の間に信頼が存在します。

ガイダンスと例については、 [Kusto 接続文字列](../../api/connection-strings/kusto.md)に関するリファレンスを参照してください。

## <a name="user-authentication"></a>ユーザー認証

ユーザー認証は、ユーザーが AAD (または、ADFS などの、AAD と連携する ID プロバイダー) に資格情報を提示すると実行されて、Kusto サービスに提示できるセキュリティ トークンを取得します。 Kusto サービスは、セキュリティ トークンの取得方法は考慮せず、トークンが有効かどうか、および AAD (または連携している IdP) によってどのような情報がそこに入れられているかを考慮します。

クライアント側では、Kusto は、AAD クライアント ライブラリ ADAL または同様のコードがユーザーに資格情報の入力を要求する対話型認証をサポートしています。 また、Kusto を使用するアプリケーションが有効なユーザー トークンを取得して提示する、トークンベースの認証もサポートしています。 最後に、Kusto を使用するアプリケーションが他のサービス (Kusto 以外) の有効なユーザー トークンを取得するシナリオをサポートしています。ただし、そのリソースと Kusto との間に信頼関係があることが条件になります。

[Kusto クライアントライブラリを使用](../../api/connection-strings/kusto.md)して、AAD を kusto に認証する方法の詳細については、kusto 接続文字列に関する説明を参照してください。

## <a name="application-authentication"></a>アプリケーション認証

要求が特定のユーザーに関連付けられていない場合、または資格情報を入力できるユーザーがいない場合は、AAD アプリケーション認証フローを使用できます。 このフローでは、アプリケーションはいくつかの秘密情報を提示することで、AAD (または連携している IdP) に対して認証を行います。 次のシナリオは、さまざまな Kusto クライアントでサポートされています。

* ローカルにインストールされた X.509v2 証明書を使用したアプリケーション認証。
* クライアント ライブラリにバイト ストリームとして提供された X.509v2 証明書を使用したアプリケーション認証。
* AAD アプリケーション ID と AAD アプリケーション キーを使用したアプリケーション認証 (アプリケーションに対するユーザー名/パスワードの認証に相当)。
* 以前に取得した有効な AAD トークン (Kusto に対して発行されたもの) を使用したアプリケーション認証。
* 以前に取得した、他のリソースに対して発行された有効な AAD トークンを使用したアプリケーション認証 (ただし、そのリソースと Kusto との間に信頼関係があることが条件になります)。

## <a name="aad-server-application-permissions"></a>AAD サーバーアプリケーションのアクセス許可

通常、AAD サーバーアプリケーションでは、複数のアクセス許可 (読み取り専用アクセス許可や読み取り/書き込みアクセス許可など) を定義できます。 AAD クライアントアプリケーションでは、承認トークンを要求するときに必要なアクセス許可を決定することができます。 トークンの取得の一環として、ユーザーは、AAD クライアントアプリケーションが、これらのアクセス許可を持っていることを承認するためにユーザーの代理として動作することを承認するように求められます。 ユーザーが承認すると、AAD クライアントアプリケーションに対して発行されたトークンのスコープ要求にこれらのアクセス許可が一覧表示されます。



AAD クライアントアプリケーションは、"アクセス Kusto" アクセス許可をユーザーに要求するように構成されています (AAD は "リソース所有者" を呼び出します)。

## <a name="kusto-client-sdk-as-an-aad-client-application"></a>AAD クライアント アプリケーションとしての Kusto クライアント SDK

Kusto クライアント ライブラリは、ADAL (AAD クライアント ライブラリ) を呼び出して、Kusto と通信するためのトークンを取得するときに、次の情報を提供します。

1. 呼び出し元から受信した AAD テナント
2. AAD クライアント アプリケーション ID
3. AAD クライアントリソース ID
4. AAD ReplyUrl (認証が正常に完了した後に AAD サービスがリダイレクトする URL)次に、ADAL はこのリダイレクトをキャプチャし、そこから認証コードを抽出します)。
5. クラスターの URI (' https://Cluster-and-region.kusto.windows.net ')。

ADAL から Kusto クライアントライブラリに返されるトークンは、対象ユーザーとして Kusto AAD サーバーアプリケーションを持ち、スコープとして "Access Kusto" アクセス許可を持っています。

## <a name="authenticating-with-aad-programmatically"></a>AAD による認証 (プログラムによる)

次の記事では、AAD を使用して Kusto に対してプログラムで認証する方法について説明します。

* [AAD アプリケーションをプロビジョニングする方法](./how-to-provision-aad-app.md)
* [AAD 認証を実行する方法](./how-to-authenticate-with-aad.md)
